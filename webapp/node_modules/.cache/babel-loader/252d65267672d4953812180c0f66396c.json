{"ast":null,"code":"export default {\n  name: \"DionysusApp\",\n\n  data() {\n    return {\n      pumpvals: null,\n      pumpvalscopy: null,\n      roundedPumpVals: null,\n      enablepump: null,\n      ingredients: null,\n      loaded: false\n    };\n  },\n\n  created: async function () {\n    let response = await fetch(\"http://localhost:8081/ingredients\");\n\n    if (response.ok) {\n      // if HTTP-status is 200-299\n      // get the response body (the method explained below)\n      this.ingredients = await response.json();\n      let initialVal = 100 / this.ingredients.length;\n      this.pumpvals = Array(this.ingredients.length).fill(initialVal);\n      this.pumpvalscopy = this.pumpvals.map(x => x);\n      this.pumpvalscopy[0] = 2;\n      this.pumpvals[0] = 1;\n      console.log(this.pumpvals[0]);\n      console.log(this.pumpvalscopy[0]);\n      this.loaded = true;\n    } else {\n      alert(\"HTTP-Error: \" + response.status);\n    }\n  },\n  methods: {\n    normalizeVals: function (index) {\n      console.log(\"Before values of pumpvals: \" + this.pumpvals[0] + \" \" + this.pumpvals[1] + \" \" + this.pumpvals[2] + \" \" + this.pumpvals[3] + \" \" + this.pumpvals[4] + \" \" + this.pumpvals[5]);\n      let absDiff = this.pumpvals[index] - this.pumpvalscopy[index];\n      let currPump = index;\n      let nActivePumps = 0;\n\n      if (this.pumpvals[index] > 1) {\n        this.enablepump[index] = true;\n      }\n\n      for (let i in this.enablepump) {\n        //compute num of active pumps\n        if (this.enablepump[i]) {\n          nActivePumps++;\n        }\n      }\n\n      let DiffPerPump = -1 * (absDiff / (nActivePumps - 1));\n\n      for (var i = 0; i < this.pumpvals.length; i++) {\n        if (this.enablepump[i] && i != index) {\n          let x = this.pumpvals[i] + Math.round(DiffPerPump);\n\n          if (x < 0.5) {\n            this.enablepump[i] = false;\n          } //disable pumps with val < 0.5, if x>= 0.5 it is rounded up to 1\n\n\n          this.pumpvals[i] = x <= 0 ? 0 : x;\n        }\n      }\n\n      nActivePumps = 0;\n\n      for (let i in this.enablepump) {\n        //compute num of the current active pumps\n        if (this.enablepump[i]) {\n          nActivePumps++;\n        }\n      }\n\n      let sum = 0;\n\n      for (let i = 0; i < this.pumpvals.length; i++) {\n        //get sum of pumpvals\n        sum += this.pumpvals[i] * 1;\n      }\n\n      let sumDiff = sum - 100; // check if the new sum is bigger than 100\n\n      let newDiffPer = sumDiff / nActivePumps;\n\n      for (let i in this.enablepump) {\n        //subtract the diff to 100, so the sum of all vals equal to 100\n        if (this.enablepump[i]) {\n          this.pumpvals[i] -= newDiffPer;\n        }\n      }\n\n      let newSum = 0;\n\n      for (let i = 0; i < this.pumpvals.length; i++) {\n        newSum += this.pumpvals[i] * 1;\n      }\n\n      for (let i = 0; i < this.pumpvals.length; i++) {\n        //update pumpvalscopy\n        this.pumpvalscopy[i] = this.pumpvals[i];\n      }\n\n      console.log(this.enablepump[0] + \" \" + this.enablepump[1] + \" \" + this.enablepump[2] + \" \" + this.enablepump[3] + \" \" + this.enablepump[4] + \" \" + this.enablepump[5]);\n      console.log(\"absDiff: \" + absDiff + \"\\ncurrPump: \" + currPump + \"\\nnActivePumps: \" + nActivePumps + \"\\nDiffPerPump: \" + DiffPerPump + \"\\nsum: \" + sum + \"\\nnewSum: \" + newSum);\n      console.log(\"After the function: \" + this.pumpvalscopy[0] + \" \" + this.pumpvalscopy[1] + \" \" + this.pumpvalscopy[2] + \" \" + this.pumpvalscopy[3] + \" \" + this.pumpvalscopy[4] + \" \" + this.pumpvalscopy[5]);\n      console.log(\" \");\n    },\n    roundVals: function () {\n      for (let i = 0; i < this.pumpvals.length; i++) {\n        this.roundedPumpVals[i] = this.pumpvals[i].toFixed(0);\n      }\n    },\n    changeCheckBox: function (index) {\n      this.enablepump[index] = !this.enablepump[index];\n\n      if (!this.enablepump[index]) {\n        this.pumpvals[index] = 0;\n      }\n    },\n    passNewVal: function (index) {\n      //pass new roundedVal to pumpvals, otherwise \"normalizeVals()\" doesnt work or new val in number input isnt updated\n      this.pumpvals[index] = this.roundedPumpVals[index];\n    }\n  }\n};","map":{"version":3,"mappings":"AAuCA,eAAe;AACbA,MAAI,EAAE,aADO;;AAEbC,MAAI,GAAG;AACL,WAAO;AACLC,cAAQ,EAAE,IADL;AAELC,kBAAY,EAAE,IAFT;AAGLC,qBAAe,EAAE,IAHZ;AAILC,gBAAU,EAAE,IAJP;AAKLC,iBAAW,EAAE,IALR;AAMLC,YAAM,EAAE;AANH,KAAP;AAQD,GAXY;;AAYbC,SAAO,EAAE,kBAAkB;AACzB,QAAIC,QAAO,GAAI,MAAMC,KAAK,CAAC,mCAAD,CAA1B;;AAEA,QAAID,QAAQ,CAACE,EAAb,EAAiB;AACf;AACA;AACA,WAAKL,WAAL,GAAmB,MAAMG,QAAQ,CAACG,IAAT,EAAzB;AACA,UAAIC,UAAS,GAAI,MAAI,KAAKP,WAAL,CAAiBQ,MAAtC;AACA,WAAKZ,QAAL,GAAgBa,KAAK,CAAC,KAAKT,WAAL,CAAiBQ,MAAlB,CAAL,CAA+BE,IAA/B,CAAoCH,UAApC,CAAhB;AACA,WAAKV,YAAL,GAAoB,KAAKD,QAAL,CAAce,GAAd,CAAkBC,KAAKA,CAAvB,CAApB;AACA,WAAKf,YAAL,CAAkB,CAAlB,IAAuB,CAAvB;AACA,WAAKD,QAAL,CAAc,CAAd,IAAmB,CAAnB;AACAiB,aAAO,CAACC,GAAR,CAAY,KAAKlB,QAAL,CAAc,CAAd,CAAZ;AACAiB,aAAO,CAACC,GAAR,CAAY,KAAKjB,YAAL,CAAkB,CAAlB,CAAZ;AACA,WAAKI,MAAL,GAAc,IAAd;AACF,KAZA,MAYO;AACLc,WAAK,CAAC,iBAAiBZ,QAAQ,CAACa,MAA3B,CAAL;AACF;AACD,GA9BY;AA+BbC,SAAO,EAAE;AACPC,iBAAa,EAAE,UAAUC,KAAV,EAAiB;AAC9BN,aAAO,CAACC,GAAR,CACE,gCACE,KAAKlB,QAAL,CAAc,CAAd,CADF,GAEE,GAFF,GAGE,KAAKA,QAAL,CAAc,CAAd,CAHF,GAIE,GAJF,GAKE,KAAKA,QAAL,CAAc,CAAd,CALF,GAME,GANF,GAOE,KAAKA,QAAL,CAAc,CAAd,CAPF,GAQE,GARF,GASE,KAAKA,QAAL,CAAc,CAAd,CATF,GAUE,GAVF,GAWE,KAAKA,QAAL,CAAc,CAAd,CAZJ;AAcA,UAAIwB,OAAM,GAAI,KAAKxB,QAAL,CAAcuB,KAAd,IAAuB,KAAKtB,YAAL,CAAkBsB,KAAlB,CAArC;AACA,UAAIE,QAAO,GAAIF,KAAf;AACA,UAAIG,YAAW,GAAI,CAAnB;;AAEA,UAAI,KAAK1B,QAAL,CAAcuB,KAAd,IAAuB,CAA3B,EAA8B;AAC5B,aAAKpB,UAAL,CAAgBoB,KAAhB,IAAyB,IAAzB;AACF;;AAEA,WAAK,IAAII,CAAT,IAAc,KAAKxB,UAAnB,EAA+B;AAC7B;AACA,YAAI,KAAKA,UAAL,CAAgBwB,CAAhB,CAAJ,EAAwB;AACtBD,sBAAY;AACd;AACF;;AACA,UAAIE,WAAU,GAAI,CAAC,CAAD,IAAMJ,OAAM,IAAKE,YAAW,GAAI,CAApB,CAAZ,CAAlB;;AAEA,WAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAI,KAAK3B,QAAL,CAAcY,MAAlC,EAA0Ce,CAAC,EAA3C,EAA+C;AAC7C,YAAI,KAAKxB,UAAL,CAAgBwB,CAAhB,KAAsBA,KAAKJ,KAA/B,EAAsC;AACpC,cAAIP,IAAI,KAAKhB,QAAL,CAAc2B,CAAd,IAAmBE,IAAI,CAACC,KAAL,CAAWF,WAAX,CAA3B;;AACA,cAAIZ,IAAI,GAAR,EAAa;AACX,iBAAKb,UAAL,CAAgBwB,CAAhB,IAAqB,KAArB;AACF,WAJoC,CAIlC;;;AACF,eAAK3B,QAAL,CAAc2B,CAAd,IAAmBX,KAAK,CAAL,GAAS,CAAT,GAAaA,CAAhC;AACF;AACF;;AAEAU,kBAAW,GAAI,CAAf;;AACA,WAAK,IAAIC,CAAT,IAAc,KAAKxB,UAAnB,EAA+B;AAC7B;AACA,YAAI,KAAKA,UAAL,CAAgBwB,CAAhB,CAAJ,EAAwB;AACtBD,sBAAY;AACd;AACF;;AAEA,UAAIK,GAAE,GAAI,CAAV;;AACA,WAAK,IAAIJ,IAAI,CAAb,EAAgBA,IAAI,KAAK3B,QAAL,CAAcY,MAAlC,EAA0Ce,CAAC,EAA3C,EAA+C;AAC7C;AACAI,WAAE,IAAK,KAAK/B,QAAL,CAAc2B,CAAd,IAAmB,CAA1B;AACF;;AAEA,UAAIK,OAAM,GAAID,GAAE,GAAI,GAApB,CAvD8B,CAuDL;;AACzB,UAAIE,UAAS,GAAID,OAAM,GAAIN,YAA3B;;AAEA,WAAK,IAAIC,CAAT,IAAc,KAAKxB,UAAnB,EAA+B;AAC7B;AACA,YAAI,KAAKA,UAAL,CAAgBwB,CAAhB,CAAJ,EAAwB;AACtB,eAAK3B,QAAL,CAAc2B,CAAd,KAAoBM,UAApB;AACF;AACF;;AAEA,UAAIC,MAAK,GAAI,CAAb;;AACA,WAAK,IAAIP,IAAI,CAAb,EAAgBA,IAAI,KAAK3B,QAAL,CAAcY,MAAlC,EAA0Ce,CAAC,EAA3C,EAA+C;AAC7CO,cAAK,IAAK,KAAKlC,QAAL,CAAc2B,CAAd,IAAmB,CAA7B;AACF;;AAEA,WAAK,IAAIA,IAAI,CAAb,EAAgBA,IAAI,KAAK3B,QAAL,CAAcY,MAAlC,EAA0Ce,CAAC,EAA3C,EAA+C;AAC7C;AACA,aAAK1B,YAAL,CAAkB0B,CAAlB,IAAuB,KAAK3B,QAAL,CAAc2B,CAAd,CAAvB;AACF;;AAEAV,aAAO,CAACC,GAAR,CACE,KAAKf,UAAL,CAAgB,CAAhB,IACE,GADF,GAEE,KAAKA,UAAL,CAAgB,CAAhB,CAFF,GAGE,GAHF,GAIE,KAAKA,UAAL,CAAgB,CAAhB,CAJF,GAKE,GALF,GAME,KAAKA,UAAL,CAAgB,CAAhB,CANF,GAOE,GAPF,GAQE,KAAKA,UAAL,CAAgB,CAAhB,CARF,GASE,GATF,GAUE,KAAKA,UAAL,CAAgB,CAAhB,CAXJ;AAaAc,aAAO,CAACC,GAAR,CACE,cACEM,OADF,GAEE,cAFF,GAGEC,QAHF,GAIE,kBAJF,GAKEC,YALF,GAME,iBANF,GAOEE,WAPF,GAQE,SARF,GASEG,GATF,GAUE,YAVF,GAWEG,MAZJ;AAcAjB,aAAO,CAACC,GAAR,CACE,yBACE,KAAKjB,YAAL,CAAkB,CAAlB,CADF,GAEE,GAFF,GAGE,KAAKA,YAAL,CAAkB,CAAlB,CAHF,GAIE,GAJF,GAKE,KAAKA,YAAL,CAAkB,CAAlB,CALF,GAME,GANF,GAOE,KAAKA,YAAL,CAAkB,CAAlB,CAPF,GAQE,GARF,GASE,KAAKA,YAAL,CAAkB,CAAlB,CATF,GAUE,GAVF,GAWE,KAAKA,YAAL,CAAkB,CAAlB,CAZJ;AAcAgB,aAAO,CAACC,GAAR,CAAY,GAAZ;AACD,KAtHM;AAuHPiB,aAAS,EAAE,YAAY;AACrB,WAAK,IAAIR,IAAI,CAAb,EAAgBA,IAAI,KAAK3B,QAAL,CAAcY,MAAlC,EAA0Ce,CAAC,EAA3C,EAA+C;AAC7C,aAAKzB,eAAL,CAAqByB,CAArB,IAA0B,KAAK3B,QAAL,CAAc2B,CAAd,EAAiBS,OAAjB,CAAyB,CAAzB,CAA1B;AACF;AACD,KA3HM;AA4HPC,kBAAc,EAAE,UAAUd,KAAV,EAAiB;AAC/B,WAAKpB,UAAL,CAAgBoB,KAAhB,IAAyB,CAAC,KAAKpB,UAAL,CAAgBoB,KAAhB,CAA1B;;AACA,UAAI,CAAC,KAAKpB,UAAL,CAAgBoB,KAAhB,CAAL,EAA6B;AAC3B,aAAKvB,QAAL,CAAcuB,KAAd,IAAuB,CAAvB;AACF;AACD,KAjIM;AAkIPe,cAAU,EAAE,UAAUf,KAAV,EAAiB;AAC3B;AACA,WAAKvB,QAAL,CAAcuB,KAAd,IAAuB,KAAKrB,eAAL,CAAqBqB,KAArB,CAAvB;AACD;AArIM;AA/BI,CAAf","names":["name","data","pumpvals","pumpvalscopy","roundedPumpVals","enablepump","ingredients","loaded","created","response","fetch","ok","json","initialVal","length","Array","fill","map","x","console","log","alert","status","methods","normalizeVals","index","absDiff","currPump","nActivePumps","i","DiffPerPump","Math","round","sum","sumDiff","newDiffPer","newSum","roundVals","toFixed","changeCheckBox","passNewVal"],"sourceRoot":"","sources":["/Users/mehmettasdemir/Desktop/OneDrive/Studium/SS2022/Multimediasysteme/dionysus-bartender/webapp/src/components/DionysusApp.vue"],"sourcesContent":["<template>\n  <div class=\"container\" v-if = \"loaded\">\n    <div class=\"sliders\">\n      <div v-for=\"(ing) in ingredients\" :key=\"ing\">\n      {{ing}}\n      <span>\n        <input\n            type=\"range\"\n            min=\"0\"\n            max=\"100\"\n            v-model.number=\"pumpvals[index]\"\n            @change=\"\n              normalizeVals(index);\n              roundVals();\n            \"\n          />\n          <input\n            type=\"number\"\n            min=\"0\"\n            max=\"100\"\n            v-model.number=\"roundedPumpVals[index]\"\n            @change=\"\n              passNewVal(index);\n              normalizeVals(index);\n              roundVals();\n            \"\n          /> \n      </span>\n    </div>\n    </div> \n    <div class=\"pictures\">pictures</div>\n    <div class=\"buttons\">\n      buttons <br />\n      <input type=\"button\" />\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"DionysusApp\",\n  data() {\n    return {\n      pumpvals: null,\n      pumpvalscopy: null,\n      roundedPumpVals: null,\n      enablepump: null,\n      ingredients: null,\n      loaded: false\n    };\n  },\n  created: async function () {\n    let response = await fetch(\"http://localhost:8081/ingredients\");\n\n    if (response.ok) {\n      // if HTTP-status is 200-299\n      // get the response body (the method explained below)\n      this.ingredients = await response.json();\n      let initialVal = 100/this.ingredients.length;\n      this.pumpvals = Array(this.ingredients.length).fill(initialVal);\n      this.pumpvalscopy = this.pumpvals.map(x => x);\n      this.pumpvalscopy[0] = 2;\n      this.pumpvals[0] = 1;\n      console.log(this.pumpvals[0]);\n      console.log(this.pumpvalscopy[0]);\n      this.loaded = true;\n    } else {\n      alert(\"HTTP-Error: \" + response.status);\n    }\n  },\n  methods: {\n    normalizeVals: function (index) {\n      console.log(\n        \"Before values of pumpvals: \" +\n          this.pumpvals[0] +\n          \" \" +\n          this.pumpvals[1] +\n          \" \" +\n          this.pumpvals[2] +\n          \" \" +\n          this.pumpvals[3] +\n          \" \" +\n          this.pumpvals[4] +\n          \" \" +\n          this.pumpvals[5]\n      );\n      let absDiff = this.pumpvals[index] - this.pumpvalscopy[index];\n      let currPump = index;\n      let nActivePumps = 0;\n\n      if (this.pumpvals[index] > 1) {\n        this.enablepump[index] = true;\n      }\n\n      for (let i in this.enablepump) {\n        //compute num of active pumps\n        if (this.enablepump[i]) {\n          nActivePumps++;\n        }\n      }\n      let DiffPerPump = -1 * (absDiff / (nActivePumps - 1));\n\n      for (var i = 0; i < this.pumpvals.length; i++) {\n        if (this.enablepump[i] && i != index) {\n          let x = this.pumpvals[i] + Math.round(DiffPerPump);\n          if (x < 0.5) {\n            this.enablepump[i] = false;\n          } //disable pumps with val < 0.5, if x>= 0.5 it is rounded up to 1\n          this.pumpvals[i] = x <= 0 ? 0 : x;\n        }\n      }\n\n      nActivePumps = 0;\n      for (let i in this.enablepump) {\n        //compute num of the current active pumps\n        if (this.enablepump[i]) {\n          nActivePumps++;\n        }\n      }\n\n      let sum = 0;\n      for (let i = 0; i < this.pumpvals.length; i++) {\n        //get sum of pumpvals\n        sum += this.pumpvals[i] * 1;\n      }\n\n      let sumDiff = sum - 100; // check if the new sum is bigger than 100\n      let newDiffPer = sumDiff / nActivePumps;\n\n      for (let i in this.enablepump) {\n        //subtract the diff to 100, so the sum of all vals equal to 100\n        if (this.enablepump[i]) {\n          this.pumpvals[i] -= newDiffPer;\n        }\n      }\n\n      let newSum = 0;\n      for (let i = 0; i < this.pumpvals.length; i++) {\n        newSum += this.pumpvals[i] * 1;\n      }\n\n      for (let i = 0; i < this.pumpvals.length; i++) {\n        //update pumpvalscopy\n        this.pumpvalscopy[i] = this.pumpvals[i];\n      }\n\n      console.log(\n        this.enablepump[0] +\n          \" \" +\n          this.enablepump[1] +\n          \" \" +\n          this.enablepump[2] +\n          \" \" +\n          this.enablepump[3] +\n          \" \" +\n          this.enablepump[4] +\n          \" \" +\n          this.enablepump[5]\n      );\n      console.log(\n        \"absDiff: \" +\n          absDiff +\n          \"\\ncurrPump: \" +\n          currPump +\n          \"\\nnActivePumps: \" +\n          nActivePumps +\n          \"\\nDiffPerPump: \" +\n          DiffPerPump +\n          \"\\nsum: \" +\n          sum +\n          \"\\nnewSum: \" +\n          newSum\n      );\n      console.log(\n        \"After the function: \" +\n          this.pumpvalscopy[0] +\n          \" \" +\n          this.pumpvalscopy[1] +\n          \" \" +\n          this.pumpvalscopy[2] +\n          \" \" +\n          this.pumpvalscopy[3] +\n          \" \" +\n          this.pumpvalscopy[4] +\n          \" \" +\n          this.pumpvalscopy[5]\n      );\n      console.log(\" \");\n    },\n    roundVals: function () {\n      for (let i = 0; i < this.pumpvals.length; i++) {\n        this.roundedPumpVals[i] = this.pumpvals[i].toFixed(0);\n      }\n    },\n    changeCheckBox: function (index) {\n      this.enablepump[index] = !this.enablepump[index];\n      if (!this.enablepump[index]) {\n        this.pumpvals[index] = 0;\n      }\n    },\n    passNewVal: function (index) {\n      //pass new roundedVal to pumpvals, otherwise \"normalizeVals()\" doesnt work or new val in number input isnt updated\n      this.pumpvals[index] = this.roundedPumpVals[index];\n    },\n  },\n};\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style>\n.container {\n  display: grid;\n  width: 100vw;\n  height: 100vh;\n  grid-auto-columns: minmax(0, 1fr);\n  grid-template-columns: 50% 50%;\n  grid-template-rows: 85% 1fr;\n  grid-template-areas:\n    \"slider pictures\"\n    \"slider buttons\";\n  gap: 5px;\n  padding: 5px;\n  box-sizing: border-box;\n}\n.sliders {\n  grid-area: slider;\n  background-color: powderblue;\n  font-size: 0.7em;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-around;\n  align-items: flex-start;\n  padding: 0.4em;\n  gap: 0.3em;\n  flex: 1 1 auto;\n  flex-wrap: wrap;\n}\n.sliders input[type=\"number\"] {\n  width: 2.5em;\n}\n.pictures {\n  grid-area: pictures;\n  background-color: red;\n}\n.buttons {\n  grid-area: buttons;\n  background-color: green;\n}\n.container div {\n  font-size: 0.7em;\n  padding: 0.1em;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}