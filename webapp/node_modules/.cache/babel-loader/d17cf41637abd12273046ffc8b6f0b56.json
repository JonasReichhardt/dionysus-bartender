{"ast":null,"code":"export default {\n  name: \"DionysusApp\",\n\n  data() {\n    return {\n      pumpvals: null,\n      pumpvalscopy: null,\n      roundedPumpVals: null,\n      enablepump: null,\n      ingredients: null,\n      loaded: false,\n      cocktails: null\n    };\n  },\n\n  created: async function () {\n    let ingResponse = await fetch(\"http://localhost:8081/ingredients\");\n\n    if (ingResponse.ok) {\n      this.ingredients = await ingResponse.json();\n      let initialVal = 100 / this.ingredients.length;\n      this.pumpvals = Array(this.ingredients.length).fill(initialVal);\n      this.pumpvalscopy = this.pumpvals.map(x => x);\n      this.roundedPumpVals = this.pumpvals.map(x => x.toFixed(0));\n      this.enablepump = Array(this.ingredients.length).fill(true);\n    } else {\n      alert(\"HTTP-Error: \" + ingResponse.status);\n      return;\n    }\n\n    let cocktailsResponse = await fetch(\"http://localhost:8081/cocktails\");\n\n    if (cocktailsResponse.ok) {\n      this.cocktails = await cocktailsResponse.json();\n    } else {\n      alert(\"HTTP-Error: \" + cocktailsResponse.status);\n      return;\n    }\n\n    this.loaded = true;\n  },\n  methods: {\n    normalizeVals: function (index) {\n      let absDiff = this.pumpvals[index] - this.pumpvalscopy[index];\n      let currPump = index;\n      let nActivePumps = 0;\n\n      if (this.pumpvals[index] > 1) {\n        this.enablepump[index] = true;\n      }\n\n      for (let i in this.enablepump) {\n        //compute num of active pumps\n        if (this.enablepump[i]) {\n          nActivePumps++;\n        }\n      }\n\n      let DiffPerPump = -1 * (absDiff / (nActivePumps - 1));\n\n      for (var i = 0; i < this.pumpvals.length; i++) {\n        if (this.enablepump[i] && i != index) {\n          let x = this.pumpvals[i] + Math.round(DiffPerPump);\n\n          if (x < 0.5) {\n            this.enablepump[i] = false;\n          } //disable pumps with val < 0.5, if x>= 0.5 it is rounded up to 1\n\n\n          this.pumpvals[i] = x <= 0 ? 0 : x;\n        }\n      }\n\n      nActivePumps = 0;\n\n      for (let i in this.enablepump) {\n        //compute num of the current active pumps\n        if (this.enablepump[i]) {\n          nActivePumps++;\n        }\n      }\n\n      let sum = 0;\n\n      for (let i = 0; i < this.pumpvals.length; i++) {\n        //get sum of pumpvals\n        sum += this.pumpvals[i] * 1;\n      }\n\n      let sumDiff = sum - 100; // check if the new sum is bigger than 100\n\n      let newDiffPer = sumDiff / nActivePumps;\n\n      for (let i in this.enablepump) {\n        //subtract the diff to 100, so the sum of all vals equal to 100\n        if (this.enablepump[i]) {\n          this.pumpvals[i] -= newDiffPer;\n        }\n      }\n\n      let newSum = 0;\n\n      for (let i = 0; i < this.pumpvals.length; i++) {\n        newSum += this.pumpvals[i] * 1;\n      }\n\n      for (let i = 0; i < this.pumpvals.length; i++) {\n        //update pumpvalscopy\n        this.pumpvalscopy[i] = this.pumpvals[i];\n      }\n\n      console.log(this.pumpvals);\n      console.log(\"rounded: \" + this.roundedPumpVals);\n      console.log(\"absDiff: \" + absDiff + \"\\ncurrPump: \" + currPump + \"\\nnActivePumps: \" + nActivePumps + \"\\nDiffPerPump: \" + DiffPerPump + \"\\nsum: \" + sum + \"\\nnewSum: \" + newSum);\n    },\n    roundVals: function () {\n      for (let i = 0; i < this.pumpvals.length; i++) {\n        this.roundedPumpVals[i] = this.pumpvals[i].toFixed(0);\n      }\n    },\n    changeCheckBox: function (index) {\n      this.enablepump[index] = !this.enablepump[index];\n\n      if (!this.enablepump[index]) {\n        this.pumpvals[index] = 0;\n      }\n    },\n    passNewVal: function (index) {\n      //pass new roundedVal to pumpvals, otherwise \"normalizeVals()\" doesnt work or new val in number input isnt updated\n      this.pumpvals[index] = this.roundedPumpVals[index];\n    },\n    passCockVal: function (index) {\n      let ctail = this.cocktails[index];\n      let amounts = [];\n      ctail.ingredients.forEach(ing => {\n        amounts.push(ing.amount);\n      });\n      let amount = amounts.reduce((a, b) => a + b);\n\n      for (let i = 0; i < ctail.ingredients.length; i++) {\n        for (let j = 0; j < this.ingredients.length; j++) {\n          if (ctail.ingredients[i].name == this.ingredients[j]) {\n            this.pumpvals[j] = amounts[i] / amount * 100;\n          }\n        }\n      }\n    }\n  }\n};","map":{"version":3,"mappings":"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","names":["name","data","pumpvals","pumpvalscopy","roundedPumpVals","enablepump","ingredients","loaded","cocktails","created","ingResponse","fetch","ok","json","initialVal","length","Array","fill","map","x","toFixed","alert","status","cocktailsResponse","methods","normalizeVals","index","absDiff","currPump","nActivePumps","i","DiffPerPump","Math","round","sum","sumDiff","newDiffPer","newSum","console","log","roundVals","changeCheckBox","passNewVal","passCockVal","ctail","amounts","forEach","ing","push","amount","reduce","a","b","j"],"sourceRoot":"","sources":["/Users/mehmettasdemir/Desktop/OneDrive/Studium/SS2022/Multimediasysteme/dionysus-bartender/webapp/src/components/DionysusApp.vue"],"sourcesContent":["<template>\n  <div class=\"container\" v-if=\"loaded\">\n    <div class=\"sliders\">\n      <div v-for=\"(ing, index) in ingredients\" :key=\"ing\">\n        {{ ing }}\n        <span>\n          <input\n            type=\"range\"\n            min=\"0\"\n            max=\"100\"\n            v-model.number=\"pumpvals[index]\"\n            @change=\"\n              normalizeVals(index);\n              roundVals();\n            \"\n          />\n          <input\n            type=\"number\"\n            min=\"0\"\n            max=\"100\"\n            v-model.number=\"pumpvals[index]\"\n            @change=\"\n              passNewVal(index);\n              normalizeVals(index);\n              roundVals();\n            \"\n          />\n        </span>\n      </div>\n    </div>\n    <div class=\"pictures\">\n      <div v-for=\"(cock, index) in cocktails\" :key=\"cock\">\n        <button @click=\"passCockVal(index)\">\n            {{cock.name}}\n        </button>\n      </div>\n    </div>\n    <div class=\"buttons\">\n      buttons <br />\n      <input type=\"button\" />\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"DionysusApp\",\n  data() {\n    return {\n      pumpvals: null,\n      pumpvalscopy: null,\n      roundedPumpVals: null,\n      enablepump: null,\n      ingredients: null,\n      loaded: false,\n      cocktails: null,\n    };\n  },\n  created: async function () {\n    let ingResponse = await fetch(\"http://localhost:8081/ingredients\");\n\n    if (ingResponse.ok) {\n      this.ingredients = await ingResponse.json();\n      let initialVal = 100 / this.ingredients.length;\n      this.pumpvals = Array(this.ingredients.length).fill(initialVal);\n      this.pumpvalscopy = this.pumpvals.map((x) => x);\n      this.roundedPumpVals = this.pumpvals.map((x) => x.toFixed(0));\n      this.enablepump = Array(this.ingredients.length).fill(true);\n    } else {\n      alert(\"HTTP-Error: \" + ingResponse.status);\n      return;\n    }\n\n    let cocktailsResponse = await fetch(\"http://localhost:8081/cocktails\");\n\n    if (cocktailsResponse.ok) {\n      this.cocktails = await cocktailsResponse.json();\n    } else {\n      alert(\"HTTP-Error: \" + cocktailsResponse.status);\n      return;\n    }\n\n    this.loaded = true;\n  },\n  methods: {\n    normalizeVals: function (index) {\n      let absDiff = this.pumpvals[index] - this.pumpvalscopy[index];\n      let currPump = index;\n      let nActivePumps = 0;\n\n      if (this.pumpvals[index] > 1) {\n        this.enablepump[index] = true;\n      }\n\n      for (let i in this.enablepump) {\n        //compute num of active pumps\n        if (this.enablepump[i]) {\n          nActivePumps++;\n        }\n      }\n      let DiffPerPump = -1 * (absDiff / (nActivePumps - 1));\n\n      for (var i = 0; i < this.pumpvals.length; i++) {\n        if (this.enablepump[i] && i != index) {\n          let x = this.pumpvals[i] + Math.round(DiffPerPump);\n          if (x < 0.5) {\n            this.enablepump[i] = false;\n          } //disable pumps with val < 0.5, if x>= 0.5 it is rounded up to 1\n          this.pumpvals[i] = x <= 0 ? 0 : x;\n        }\n      }\n\n      nActivePumps = 0;\n      for (let i in this.enablepump) {\n        //compute num of the current active pumps\n        if (this.enablepump[i]) {\n          nActivePumps++;\n        }\n      }\n\n      let sum = 0;\n      for (let i = 0; i < this.pumpvals.length; i++) {\n        //get sum of pumpvals\n        sum += this.pumpvals[i] * 1;\n      }\n\n      let sumDiff = sum - 100; // check if the new sum is bigger than 100\n      let newDiffPer = sumDiff / nActivePumps;\n\n      for (let i in this.enablepump) {\n        //subtract the diff to 100, so the sum of all vals equal to 100\n        if (this.enablepump[i]) {\n          this.pumpvals[i] -= newDiffPer;\n        }\n      }\n\n      let newSum = 0;\n      for (let i = 0; i < this.pumpvals.length; i++) {\n        newSum += this.pumpvals[i] * 1;\n      }\n\n      for (let i = 0; i < this.pumpvals.length; i++) {\n        //update pumpvalscopy\n        this.pumpvalscopy[i] = this.pumpvals[i];\n      }\n      console.log(this.pumpvals);\n      console.log(\"rounded: \" + this.roundedPumpVals);\n\n      console.log(\n        \"absDiff: \" +\n          absDiff +\n          \"\\ncurrPump: \" +\n          currPump +\n          \"\\nnActivePumps: \" +\n          nActivePumps +\n          \"\\nDiffPerPump: \" +\n          DiffPerPump +\n          \"\\nsum: \" +\n          sum +\n          \"\\nnewSum: \" +\n          newSum\n      );\n    },\n    roundVals: function () {\n      for (let i = 0; i < this.pumpvals.length; i++) {\n        this.roundedPumpVals[i] = this.pumpvals[i].toFixed(0);\n      }\n    },\n    changeCheckBox: function (index) {\n      this.enablepump[index] = !this.enablepump[index];\n      if (!this.enablepump[index]) {\n        this.pumpvals[index] = 0;\n      }\n    },\n    passNewVal: function (index) {\n      //pass new roundedVal to pumpvals, otherwise \"normalizeVals()\" doesnt work or new val in number input isnt updated\n      this.pumpvals[index] = this.roundedPumpVals[index];\n    },\n    passCockVal: function (index) {\n      let ctail = this.cocktails[index];\n      let amounts = [] \n      ctail.ingredients.forEach(ing => {\n        amounts.push(ing.amount)\n      });\n\n      let amount = amounts.reduce((a, b) => a + b)\n      \n      for(let i = 0; i<ctail.ingredients.length; i++){\n        for(let j = 0; j<this.ingredients.length; j++){\n          if(ctail.ingredients[i].name == this.ingredients[j]){\n            this.pumpvals[j] = (amounts[i]/amount) * 100\n          }\n        }\n      }\n    }\n  },\n};\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style>\n.container {\n  display: grid;\n  width: 100vw;\n  height: 100vh;\n  grid-auto-columns: minmax(0, 1fr);\n  grid-template-columns: 50% 50%;\n  grid-template-rows: 85% 1fr;\n  grid-template-areas:\n    \"slider pictures\"\n    \"slider buttons\";\n  gap: 5px;\n  padding: 5px;\n  box-sizing: border-box;\n}\n.sliders {\n  grid-area: slider;\n  background-color: powderblue;\n  font-size: 0.7em;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-around;\n  align-items: flex-start;\n  padding: 0.4em;\n  gap: 0.3em;\n  flex: 1 1 auto;\n  flex-wrap: wrap;\n}\n.sliders input[type=\"number\"] {\n  width: 2.5em;\n}\n.pictures {\n  grid-area: pictures;\n}\n.buttons {\n  grid-area: buttons;\n  background-color: green;\n}\n.container div {\n  font-size: 0.7em;\n  padding: 0.1em;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}