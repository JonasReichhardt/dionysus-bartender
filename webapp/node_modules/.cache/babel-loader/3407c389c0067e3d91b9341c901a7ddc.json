{"ast":null,"code":"import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, vModelText as _vModelText, createElementVNode as _createElementVNode, withDirectives as _withDirectives, createTextVNode as _createTextVNode, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n  key: 0,\n  class: \"container\"\n};\nconst _hoisted_2 = {\n  class: \"sliders\"\n};\nconst _hoisted_3 = [\"onUpdate:modelValue\", \"onChange\"];\nconst _hoisted_4 = [\"onUpdate:modelValue\", \"onChange\"];\nconst _hoisted_5 = {\n  class: \"pictures\"\n};\n\nconst _hoisted_6 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"buttons\"\n}, [/*#__PURE__*/_createTextVNode(\" buttons \"), /*#__PURE__*/_createElementVNode(\"br\"), /*#__PURE__*/_createElementVNode(\"input\", {\n  type: \"button\"\n})], -1\n/* HOISTED */\n);\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return $data.loaded ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.ingredients, (ing, index) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: ing\n    }, [_createTextVNode(_toDisplayString(ing) + \" \", 1\n    /* TEXT */\n    ), _createElementVNode(\"span\", null, [_withDirectives(_createElementVNode(\"input\", {\n      type: \"range\",\n      min: \"0\",\n      max: \"100\",\n      \"onUpdate:modelValue\": $event => $data.pumpvals[index] = $event,\n      onChange: $event => {\n        $options.normalizeVals(index);\n        $options.roundVals();\n      }\n    }, null, 40\n    /* PROPS, HYDRATE_EVENTS */\n    , _hoisted_3), [[_vModelText, $data.pumpvals[index], void 0, {\n      number: true\n    }]]), _withDirectives(_createElementVNode(\"input\", {\n      type: \"number\",\n      min: \"0\",\n      max: \"100\",\n      \"onUpdate:modelValue\": $event => $data.roundedPumpVals[index] = $event,\n      onChange: $event => {\n        $options.passNewVal(index);\n        $options.normalizeVals(index);\n        $options.roundVals();\n      }\n    }, null, 40\n    /* PROPS, HYDRATE_EVENTS */\n    , _hoisted_4), [[_vModelText, $data.roundedPumpVals[index], void 0, {\n      number: true\n    }]])])]);\n  }), 128\n  /* KEYED_FRAGMENT */\n  ))]), _createElementVNode(\"div\", _hoisted_5, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.cocktails, (cock, index) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: cock\n    }, _toDisplayString(index) + \" \" + _toDisplayString(cock), 1\n    /* TEXT */\n    );\n  }), 128\n  /* KEYED_FRAGMENT */\n  ))]), _hoisted_6])) : _createCommentVNode(\"v-if\", true);\n}","map":{"version":3,"mappings":";;;AACOA,OAAK,EAAC;;;AACJA,OAAK,EAAC;;;;;AA4BNA,OAAK,EAAC;;;gCAMXC,oBAGM,KAHN,EAGM;AAHDD,OAAK,EAAC;AAGL,CAHN,EAAoB,+BAAC,YAAD,eACVC,oBAAM,IAAN,CADU,eAElBA,oBAAuB,OAAvB,EAAuB;AAAhBC,MAAI,EAAC;AAAW,CAAvB,CAFkB,CAApB;;AAAA;;;SAnC2BC,8BAA7BC,oBAuCM,KAvCN,cAuCM,CAtCJH,oBA2BM,KA3BN,cA2BM,oBA1BJG,oBAyBMC,SAzBN,EAyBM,IAzBN,EAyBMC,YAzBsBH,iBAyBtB,EAzBiC,CAA1BI,GAA0B,EAArBC,KAAqB,KAAhB;yBAAvBJ,oBAyBM,KAzBN,EAyBM;AAzBoCK,SAAG,EAAEF;AAyBzC,KAzBN,EAAkD,mCAC7CA,OAAM,KACT;AAAA;KAFgD,EAEhDN,oBAsBO,MAtBP,EAsBO,IAtBP,EAsBO,iBArBLA,oBASE,OATF,EASE;AARAC,UAAI,EAAC,OAQL;AAPAQ,SAAG,EAAC,GAOJ;AANAC,SAAG,EAAC,KAMJ;uCALgBR,eAASK,KAAT,IAAcI,MAK9B;AAJCC,cAAM;AAAiBC,+BAAcN,KAAd;AAAoCM;;AAI5D,KATF;;AAAA,kCAIkBX,eAASK,KAAT;cAAhB;QAiBG,kBAXLP,oBAUE,OAVF,EAUE;AATAC,UAAI,EAAC,QASL;AARAQ,SAAG,EAAC,GAQJ;AAPAC,SAAG,EAAC,KAOJ;uCANgBR,sBAAgBK,KAAhB,IAAqBI,MAMrC;AALCC,cAAM;AAAiBC,4BAAWN,KAAX;AAAiCM,+BAAcN,KAAd;AAAoCM;;AAK7F,KAVF;;AAAA,kCAIkBX,sBAAgBK,KAAhB;cAAhB;QAOG,CAtBP,CAFgD,CAAlD;GAyBM,CAzBN;;AAAA,GA0BI,EA3BN,CAsCI,EAVJP,oBAKM,KALN,cAKM,oBAJJG,oBAGMC,SAHN,EAGM,IAHN,EAGMC,YAHuBH,eAGvB,EAHgC,CAAzBY,IAAyB,EAAnBP,KAAmB,KAAd;yBAAxBJ,oBAGM,KAHN,EAGM;AAHmCK,SAAG,EAAEM;AAGxC,KAHN,EAAkDC,iBAC9CR,KAD8C,IACvC,GADuC,GAEhDQ,iBAAGD,IAAH,CAFF,EAES;AAAA;AAFT;GAGM,CAHN;;AAAA,GAII,EALN,CAUI,EAJJE,UAII,CAvCN","names":["class","_createElementVNode","type","$data","_createElementBlock","_Fragment","_renderList","ing","index","key","min","max","$event","onChange","$options","cock","_toDisplayString","_hoisted_6"],"sourceRoot":"","sources":["/Users/mehmettasdemir/Desktop/OneDrive/Studium/SS2022/Multimediasysteme/dionysus-bartender/webapp/src/components/DionysusApp.vue"],"sourcesContent":["<template>\n  <div class=\"container\" v-if=\"loaded\">\n    <div class=\"sliders\">\n      <div v-for=\"(ing, index) in ingredients\" :key=\"ing\">\n        {{ ing }}\n        <span>\n          <input\n            type=\"range\"\n            min=\"0\"\n            max=\"100\"\n            v-model.number=\"pumpvals[index]\"\n            @change=\"\n              normalizeVals(index);\n              roundVals();\n            \"\n          />\n          <input\n            type=\"number\"\n            min=\"0\"\n            max=\"100\"\n            v-model.number=\"roundedPumpVals[index]\"\n            @change=\"\n              passNewVal(index);\n              normalizeVals(index);\n              roundVals();\n            \"\n          />\n        </span>\n      </div>\n    </div>\n    <div class=\"pictures\">\n      <div v-for=\"(cock, index) in cocktails\" :key=\"cock\">\n        {{index}}\n        {{ cock}}\n      </div>\n    </div>\n    <div class=\"buttons\">\n      buttons <br />\n      <input type=\"button\" />\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"DionysusApp\",\n  data() {\n    return {\n      pumpvals: null,\n      pumpvalscopy: null,\n      roundedPumpVals: null,\n      enablepump: null,\n      ingredients: null,\n      loaded: false,\n      cocktails: null,\n    };\n  },\n  created: async function () {\n    let ingResponse = await fetch(\"http://localhost:8081/ingredients\");\n\n    if (ingResponse.ok) {\n      this.ingredients = await ingResponse.json();\n      let initialVal = 100 / this.ingredients.length;\n      this.pumpvals = Array(this.ingredients.length).fill(initialVal);\n      this.pumpvalscopy = this.pumpvals.map((x) => x);\n      this.roundedPumpVals = this.pumpvals.map((x) => x.toFixed(0));\n      this.enablepump = Array(this.ingredients.length).fill(true);\n    } else {\n      alert(\"HTTP-Error: \" + ingResponse.status);\n      return;\n    }\n\n    let cocktailsResponse = await fetch(\"http://localhost:8081/cocktails\");\n\n    if (cocktailsResponse.ok) {\n      this.cocktails = await cocktailsResponse.json();\n    } else {\n      alert(\"HTTP-Error: \" + cocktailsResponse.status);\n      return;\n    }\n\n    this.loaded = true;\n  },\n  methods: {\n    normalizeVals: function (index) {\n      let absDiff = this.pumpvals[index] - this.pumpvalscopy[index];\n      let currPump = index;\n      let nActivePumps = 0;\n\n      if (this.pumpvals[index] > 1) {\n        this.enablepump[index] = true;\n      }\n\n      for (let i in this.enablepump) {\n        //compute num of active pumps\n        if (this.enablepump[i]) {\n          nActivePumps++;\n        }\n      }\n      let DiffPerPump = -1 * (absDiff / (nActivePumps - 1));\n\n      for (var i = 0; i < this.pumpvals.length; i++) {\n        if (this.enablepump[i] && i != index) {\n          let x = this.pumpvals[i] + Math.round(DiffPerPump);\n          if (x < 0.5) {\n            this.enablepump[i] = false;\n          } //disable pumps with val < 0.5, if x>= 0.5 it is rounded up to 1\n          this.pumpvals[i] = x <= 0 ? 0 : x;\n        }\n      }\n\n      nActivePumps = 0;\n      for (let i in this.enablepump) {\n        //compute num of the current active pumps\n        if (this.enablepump[i]) {\n          nActivePumps++;\n        }\n      }\n\n      let sum = 0;\n      for (let i = 0; i < this.pumpvals.length; i++) {\n        //get sum of pumpvals\n        sum += this.pumpvals[i] * 1;\n      }\n\n      let sumDiff = sum - 100; // check if the new sum is bigger than 100\n      let newDiffPer = sumDiff / nActivePumps;\n\n      for (let i in this.enablepump) {\n        //subtract the diff to 100, so the sum of all vals equal to 100\n        if (this.enablepump[i]) {\n          this.pumpvals[i] -= newDiffPer;\n        }\n      }\n\n      let newSum = 0;\n      for (let i = 0; i < this.pumpvals.length; i++) {\n        newSum += this.pumpvals[i] * 1;\n      }\n\n      for (let i = 0; i < this.pumpvals.length; i++) {\n        //update pumpvalscopy\n        this.pumpvalscopy[i] = this.pumpvals[i];\n      }\n      console.log(this.pumpvals);\n      console.log(\"rounded: \" + this.roundedPumpVals);\n\n      console.log(\n        \"absDiff: \" +\n          absDiff +\n          \"\\ncurrPump: \" +\n          currPump +\n          \"\\nnActivePumps: \" +\n          nActivePumps +\n          \"\\nDiffPerPump: \" +\n          DiffPerPump +\n          \"\\nsum: \" +\n          sum +\n          \"\\nnewSum: \" +\n          newSum\n      );\n    },\n    roundVals: function () {\n      for (let i = 0; i < this.pumpvals.length; i++) {\n        this.roundedPumpVals[i] = this.pumpvals[i].toFixed(0);\n      }\n    },\n    changeCheckBox: function (index) {\n      this.enablepump[index] = !this.enablepump[index];\n      if (!this.enablepump[index]) {\n        this.pumpvals[index] = 0;\n      }\n    },\n    passNewVal: function (index) {\n      //pass new roundedVal to pumpvals, otherwise \"normalizeVals()\" doesnt work or new val in number input isnt updated\n      this.pumpvals[index] = this.roundedPumpVals[index];\n    },\n  },\n};\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style>\n.container {\n  display: grid;\n  width: 100vw;\n  height: 100vh;\n  grid-auto-columns: minmax(0, 1fr);\n  grid-template-columns: 50% 50%;\n  grid-template-rows: 85% 1fr;\n  grid-template-areas:\n    \"slider pictures\"\n    \"slider buttons\";\n  gap: 5px;\n  padding: 5px;\n  box-sizing: border-box;\n}\n.sliders {\n  grid-area: slider;\n  background-color: powderblue;\n  font-size: 0.7em;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-around;\n  align-items: flex-start;\n  padding: 0.4em;\n  gap: 0.3em;\n  flex: 1 1 auto;\n  flex-wrap: wrap;\n}\n.sliders input[type=\"number\"] {\n  width: 2.5em;\n}\n.pictures {\n  grid-area: pictures;\n}\n.buttons {\n  grid-area: buttons;\n  background-color: green;\n}\n.container div {\n  font-size: 0.7em;\n  padding: 0.1em;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}